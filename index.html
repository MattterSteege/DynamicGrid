<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="DynamicGrid.css">
    <link rel="stylesheet" href="https://fa.kronk.tech">
  <script src="DynamicGrid/DynamicGrid.js"></script>
  <script src="DynamicGrid/DynamicGridUI.js"></script>
  <script src="DynamicGrid/TypePlugin.js"></script>
  <script src="DynamicGrid/InherentTypePlugin.js"></script>
  <script src="DynamicGrid/SJQLEngine.js"></script>
  <script src="DynamicGrid/QueryParser.js"></script>
  <script src="DynamicGrid/DynamicGridUtils.js"></script>
  <script src="DynamicGrid/ContextMenu.js"></script>
<!--    <script src="/dist/DynamicGrid.js"></script>-->
</head>
<body>

<input type="file" id="file" accept=".csv, .json" onchange="handleFile(this.files[0])">
<input type="text" id="search" style="width: 50%;">
<button onclick="grid.render(document.getElementById('search').value)">Search</button>

<div id="gridContainer" style="width: 90vw; height: 90vh; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 10px; overflow: auto;"></div>

<script>
    let grid = new DynamicGrid({
        // headers: {
        //     id: 'number',
        //     guid: 'string',
        //     isActive: 'boolean',
        //     balance: 'number',
        //     age: 'number',
        //     name: 'string',
        //     gender: 'string',
        //     email: 'string'
        // },
        ui: {
            containerId: '#gridContainer',
            paginationPageSize: 100,
        },
        engine: {
            UseDataEnumeration: false,
            UseDataIndexing: true,
            StrictCase: false,
            //SymbolsToIgnore: [" ", "_", "-"],
        }
    });
    function createTable(data) {
        grid.importData(data, {type: "csv", delimiter: ","});
        grid.render();
    }




    function handleFile(file) {
        const reader = new FileReader();
        reader.onload = function (e) {
            grid.importData(e.target.result, {type: file.type.split("/")[1], delimiter: ","});
            grid.render();
        }
        reader.readAsText(file);
    }

    function testQuerySystem(query, testCount = 1000)
    {
        //id > 50 and isActive == true and balance > 2000
        var t0 = performance.now();
        var count = 0;
        for (let i = 0; i < testCount; i++)
        {
            const a = grid.engine.query(query);
            count += a.length;
        }
        console.log(count / testCount);
        var t1 = performance.now();
        console.log("Query took " + (t1 - t0) / 1000 + " seconds.\n" + (testCount / (t1 - t0)) + " queries per second.\n" + (t1 - t0) / testCount + " milliseconds per query.");
        performance.clearMarks();
        performance.clearMeasures();
    }

    // Example usage:
    const menu = new ContextMenu({
        theme: 'dark',
        width: 250,
        animation: { duration: 150 },
    });

    menu.button('New File', () => console.log('New File'), { icon: 'ðŸ“„' })
        .button('Open...', () => console.log('Open'), { icon: 'ðŸ“‚' })
        .separator()
        .submenu('Recent Files', submenu => {
            submenu.button('doc1.txt', () => console.log('doc1.txt'))
                    .button('doc2.txt', () => console.log('doc2.txt'))
                    .submenu('Recent Files', submenu => {
                            submenu.button('doc1.txt', () => console.log('doc1.txt'))
                                    .button('doc2.txt', () => console.log('doc2.txt'))
                                .submenu('Recent Files', submenu => {
                                    submenu.button('doc1.txt', () => console.log('doc1.txt'))
                                        .button('doc2.txt', () => console.log('doc2.txt'));
                                },{icon: 'ðŸ•’'});
                    },{icon: 'ðŸ•’'});
        },{icon: 'ðŸ•’'})
        .separator()
        .input('Search', {
            placeholder: 'Type to search...',
            onChange: value => console.log(value)
        })
        .dropdown('Sort by', [
            { value: 'name', label: 'Name' },
            { value: 'date', label: 'Date' }
        ],
        {
            onChange: value => console.log(value)
        })
        .checkbox('Show Hidden Files', {
            checked: true,
            onChange: checked => console.log(checked)
        })
        .radioGroup('View', [
            { text: 'List', value: 'list' },
            { text: 'Grid', value: 'grid' }
        ],{
            onChange: value => console.log(value)
        })
    ;

    menu.showAt(500, 100)
</script>

</body>
</html>