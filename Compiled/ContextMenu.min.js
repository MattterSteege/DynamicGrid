class ContextMenu{static ITEM_TYPES={BUTTON:"button",SEPARATOR:"separator",SUBMENU:"submenu",INPUT:"input",DROPDOWN:"dropdown",CHECKBOX:"checkbox",RADIO:"radio",SEARCH_SELECT:"search-select"};static CLASSNAMES={BUTTON:"context-menu-button",SUBMENU:"context-menu-submenu",SEPARATOR:"context-menu-separator",MENU:"context-menu",INPUT:"context-menu-input",DROPDOWN:"context-menu-dropdown",CHECKBOX:"context-menu-checkbox",RADIO:"context-menu-radio",CONTAINER:"context-menu-container",SEARCH_SELECT:"context-menu-search-select",ICON:"context-menu-icon",LABEL:"context-menu-label"};constructor(e={}){this.options={width:e.width||200,animation:{enabled:e.animation?.enabled??!0,duration:e.animation?.duration||200,timing:e.animation?.timing||"ease-out"},position:{xOffset:e.position?.xOffset||0,yOffset:e.position?.yOffset||0},icons:e.icons||{submenu:"❯"},style:{backgroundColor:e.style?.backgroundColor||"#ffffff",textColor:e.style?.textColor||"#333333",backgroundHoverColor:e.style?.backgroundHoverColor||"#f0f0f0",border:e.style?.border||"rgba(0, 0, 0, 0.08)",shadow:e.style?.shadow||"0 10px 25px rgba(0, 0, 0, 0.1)",accent:e.style?.accent||"#3b82f6",separator:e.style?.separator||"rgba(0, 0, 0, 0.08)",padding:e.style?.padding||"10px",paddingHorizontal:e.style?.paddingHorizontal||"15px",gap:e.style?.gap||"10px",borderRadius:e.style?.borderRadius||"8px",borderRadiusInput:e.style?.borderRadiusInput||"4px",fontSize:e.style?.fontSize||"14px",transition:e.style?.transition||"0.2s",transitionFast:e.style?.transitionFast||"0.1s",transitionInput:e.style?.transitionInput||"0.2s"},indentLevel:e.indentLevel||0,isRoot:void 0===e.isRoot,closeOnClick:e.closeOnClick,closeOnOutsideClick:e.closeOnOutsideClick},this.items=[],this.id=this.#e(),this.installStyles()}addItem(e,t){const n={id:(t?.id??this.#e())+"",type:e,position:this.items.length,...t};return void 0===n.id&&(n.id=this.#e()),n.type===ContextMenu.ITEM_TYPES.SUBMENU&&(n.submenu.options.indentLevel=(this.options.indentLevel||0)+1),this.#t(n),this.items.push(n),this}button(e,t,n={}){return this.addItem(ContextMenu.ITEM_TYPES.BUTTON,{text:e,action:t,icon:n.icon,ficon:n.ficon,disabled:n.disabled,marked:n.marked,showWhen:n.showWhen,id:n.id})}input(e,t={}){return this.addItem(ContextMenu.ITEM_TYPES.INPUT,{label:e,placeholder:t.placeholder,value:t.value,onChange:t.onChange,showWhen:t.showWhen,id:t.id})}dropdown(e,t,n={}){return this.addItem(ContextMenu.ITEM_TYPES.DROPDOWN,{label:e,options:t,value:n.value,onChange:n.onChange,multiSelect:n.multiSelect,showWhen:n.showWhen,id:n.id})}checkbox(e,t={}){return this.addItem(ContextMenu.ITEM_TYPES.CHECKBOX,{text:e,checked:t.checked||!1,onChange:t.onChange,showWhen:t.showWhen,id:t.id})}radioGroup(e,t,n={}){return t.forEach((t=>{this.addItem(ContextMenu.ITEM_TYPES.RADIO,{label:t.label,value:t.value,name:e,checked:t.checked,onChange:n.onChange,showWhen:n.showWhen,id:n.id})})),this}separator(){return this.addItem(ContextMenu.ITEM_TYPES.SEPARATOR,{})}submenu(e,t,n={}){const o={...this.options,isRoot:!1,indentLevel:(this.options.indentLevel||0)+1,showWhen:n.showWhen,id:n.id},a=new ContextMenu(o);t(a);const i=this.addItem(ContextMenu.ITEM_TYPES.SUBMENU,{text:e,submenu:a,icon:n.icon,ficon:n.ficon,showWhen:n.showWhen,id:n.id}).items;return i[i.length-1].id=a.id,this}searchSelect(e,t,n={}){return this.addItem(ContextMenu.ITEM_TYPES.SEARCH_SELECT,{label:e,options:t,value:n.value,onChange:n.onChange,showWhen:n.showWhen,id:n.id})}showAt(e,t,n=!0){const o=this.#n();return document.getElementById(this.id)&&document.getElementById(this.id).remove(),n&&document.body.appendChild(o),this.#o(o),this.#a(o,{x:e,y:t,position:"fixed"}),this.#i(o),console.log(o),o}destroy(){const e=document.querySelector("body > ."+ContextMenu.CLASSNAMES.MENU);e&&e.remove();const{handleClick:t,handleContextMenu:n,handleMouseOver:o}=this._eventHandlers||{};t&&document.removeEventListener("click",t),n&&document.removeEventListener("contextmenu",n),o&&document.removeEventListener("mouseover",o),this?.clear()}clear(){this.items=[];const e=document.getElementById(this.id);e&&(e.innerHTML="")}#o(e){const t=e=>{const t=e.target;if(t.className===ContextMenu.CLASSNAMES.MENU)return void t.remove();const n=document.getElementById(t.dataset?.submenuId),o=t.matches(":hover"),a=n?.matches(":hover");o||a||n?.remove()};e.addEventListener("click",(e=>{if(!(e.target.classList.contains(ContextMenu.CLASSNAMES.DROPDOWN)||e.target.classList.contains(ContextMenu.CLASSNAMES.INPUT)||e.target.classList.contains(ContextMenu.CLASSNAMES.CHECKBOX)||e.target.classList.contains(ContextMenu.CLASSNAMES.RADIO)||e.target.classList.contains(ContextMenu.CLASSNAMES.SEARCH_SELECT))){if(e.target.classList.contains(ContextMenu.CLASSNAMES.BUTTON)){const t=this.items.find((t=>t.id===e.target.id));t&&(t.action(),this.destroy())}if(!e.target.closest("."+ContextMenu.CLASSNAMES.MENU)){if(!this.options.closeOnOutsideClick)return;this.destroy()}}})),e.addEventListener("mouseover",(e=>{if(e.target.classList.contains(ContextMenu.CLASSNAMES.SUBMENU)){const n=this.items.find((t=>t.id===e.target.dataset.submenuId));if(n){if(e.target.parentElement.querySelector("#"+n.submenu.id))return;const o=n.submenu.#n();n.submenu.#o(o),n.submenu.#a(o,{x:e.target.getBoundingClientRect().right,y:e.target.getBoundingClientRect().top}),o.style.position="absolute",o.style.left=this.options.width+"px",o.style.top=e.target.getBoundingClientRect().top-e.target.parentElement.getBoundingClientRect().top+"px",e.target.parentElement.appendChild(o),o.addEventListener("mouseleave",t),e.target.addEventListener("mouseleave",t)}}})),addEventListener("click",(e=>{e.target.closest("."+ContextMenu.CLASSNAMES.MENU)||this.options.closeOnOutsideClick&&this.destroy()}))}#t(e){const t=Object.values(ContextMenu.ITEM_TYPES);if(!e.type||!t.includes(e.type))throw new Error(`Invalid item type: ${e.type}. Allowed types are: ${t.join(", ")}`);switch(e.type){case ContextMenu.ITEM_TYPES.BUTTON:if(!e.text||"string"!=typeof e.text)throw new Error('Button item must have a "text" property of type string.');if(e.action&&"function"!=typeof e.action)throw new Error("Button item action must be a function.");break;case ContextMenu.ITEM_TYPES.SEPARATOR:break;case ContextMenu.ITEM_TYPES.SUBMENU:if(!(e.submenu&&e.submenu instanceof ContextMenu))throw new Error('Submenu item must have a "submenu" property that is an instance of ContextMenu.');break;case ContextMenu.ITEM_TYPES.INPUT:if(!e.label||"string"!=typeof e.label)throw new Error('Input item must have a "label" property of type string.');break;case ContextMenu.ITEM_TYPES.DROPDOWN:if(!e.label||"string"!=typeof e.label)throw new Error('Dropdown item must have a "label" property of type string.');if(!Array.isArray(e.options)||0===e.options.length)throw new Error('Dropdown item must have a non-empty "options" array.');break;case ContextMenu.ITEM_TYPES.CHECKBOX:if(!e.text||"string"!=typeof e.text)throw new Error('Checkbox item must have a "text" property of type string.');if("boolean"!=typeof e.checked)throw new Error('Checkbox item must have a "checked" property of type boolean.');break;case ContextMenu.ITEM_TYPES.RADIO:if(!e.label||"string"!=typeof e.label)throw new Error('Radio item must have a "label" property of type string.');if(!e.name||"string"!=typeof e.name)throw new Error('Radio item must have a "name" property of type string.');break;case ContextMenu.ITEM_TYPES.SEARCH_SELECT:if(!e.label||"string"!=typeof e.label)throw new Error('SearchSelect item must have a "label" property of type string.');if(!Array.isArray(e.options)||0===e.options.length)throw new Error('SearchSelect item must have a non-empty "options" array.');break;default:throw new Error(`Unhandled item type: ${e.type}`)}}#e(){return"_"+Math.random().toString(36).substring(2,9)}#n(){console.log(this.items);const e=document.createElement("div");return e.classList.add(ContextMenu.CLASSNAMES.MENU),e.id=this.id,e.setAttribute("role","menu"),e.setAttribute("aria-orientation","vertical"),e.style.width=`${this.options.width}px`,e.dataset.indent=this.options.indentLevel,this.items.forEach((t=>{let n;switch(t.type){case ContextMenu.ITEM_TYPES.BUTTON:n=this.#r(t);break;case ContextMenu.ITEM_TYPES.SEPARATOR:n=this.#s();break;case ContextMenu.ITEM_TYPES.SUBMENU:n=this.#c(t);break;case ContextMenu.ITEM_TYPES.INPUT:n=this.#d(t);break;case ContextMenu.ITEM_TYPES.DROPDOWN:n=this.#u(t);break;case ContextMenu.ITEM_TYPES.CHECKBOX:n=this.#l(t);break;case ContextMenu.ITEM_TYPES.RADIO:n=this.#p(t);break;case ContextMenu.ITEM_TYPES.SEARCH_SELECT:n=this.#m(t);break;default:console.warn(`Unknown item type: ${t.type}`)}n&&e.appendChild(n),setTimeout((()=>{if(t.showWhen){const{elementId:e,value:o}=t.showWhen,a=document.querySelector("#"+e);if(a){const e=()=>{const e=o.includes(a.value);n.style.display=e?"block":"none"};a.addEventListener("input",e),a.addEventListener("change",e),e()}}}),0)})),e}#r(e){const t=document.createElement("button");if(t.classList.add(ContextMenu.CLASSNAMES.BUTTON),t.id=e.id,t.innerText=e.text,t.disabled=e.disabled||!1,t.dataset.marked=e.marked||!1,e.icon){const n=document.createElement("span");n.innerText=e.icon,t.prepend(n)}if(e.ficon){const n=document.createElement("i");n.className=e.ficon,t.append(n)}return t}#s(){const e=document.createElement("div");return e.classList.add(ContextMenu.CLASSNAMES.SEPARATOR),e}#c(e){const t=document.createElement("button");if(t.classList.add(ContextMenu.CLASSNAMES.SUBMENU),t.innerText=e.text,t.setAttribute("aria-haspopup","true"),t.dataset.submenuId=e.id,e.icon){const n=document.createElement("span");n.innerText=e.icon,t.prepend(n)}const n=document.createElement("span");if(n.innerText=this.options.icons.submenu,n.style.marginLeft="auto",t.append(n),e.ficon){const n=document.createElement("i");n.className=e.ficon,t.append(n)}return t}#d(e){const t=document.createElement("div");t.classList.add(ContextMenu.CLASSNAMES.INPUT);const n=document.createElement("input");return n.type=e.type||"text",n.placeholder=e.placeholder||"",n.value=e.value||"",n.oninput=t=>e.onChange?.(t.target.value),n.id=e.id,t.appendChild(n),t}#u(e){const t=document.createElement("select");return t.classList.add(ContextMenu.CLASSNAMES.DROPDOWN),t.id=e.id,e.options.forEach((n=>{const o=document.createElement("option");o.value=n.value,o.textContent=n.label,n.value===e.value&&(o.selected=!0),t.appendChild(o)})),t.onchange=t=>e.onChange?.(t.target.value),t}#l(e){const t=document.createElement("label");t.classList.add(ContextMenu.CLASSNAMES.CHECKBOX);const n=document.createElement("input");n.type="checkbox",n.checked=e.checked||!1,n.onchange=t=>e.onChange?.(t.target.checked),n.id=e.id;const o=document.createElement("span");return o.textContent=e.text,t.appendChild(n),t.appendChild(o),t}#p(e){const t=document.createElement("label");t.classList.add(ContextMenu.CLASSNAMES.RADIO);const n=document.createElement("input");n.type="radio",n.name=e.name,n.value=e.value,n.checked=e.checked||!1,n.onchange=t=>e.onChange?.(t.target.value),n.id=e.id;const o=document.createElement("span");return o.textContent=e.label,t.appendChild(n),t.appendChild(o),t}#m(e){const t=document.createElement("div");t.classList.add(ContextMenu.CLASSNAMES.SEARCH_SELECT),t.id=e.id;const n=document.createElement("input");n.type="text",n.placeholder=e.label||"";const o=document.createElement("div");o.classList.add(ContextMenu.CLASSNAMES.SEARCH_SELECT+"-list");const a=document.createElement("button");return a.textContent="Toggle All",a.onclick=n=>{const a=o.querySelectorAll('input[type="checkbox"]'),i=Array.from(a).every((e=>e.checked));a.forEach((e=>{e.checked=!i}));const r=Array.from(o.querySelectorAll('input[type="checkbox"]:checked')).map((e=>e.value));e.onChange?.(r),t.value=r},o.appendChild(a),e.options.forEach((n=>{const a=document.createElement("input");a.type="checkbox",a.value=n.value,a.checked=n.checked||!1,a.onchange=n=>{const a=Array.from(o.querySelectorAll('input[type="checkbox"]:checked')).map((e=>e.value));e.onChange?.(a),t.value=a};const i=document.createElement("label");i.textContent=n.label,i.appendChild(a),o.appendChild(i)})),t.appendChild(n),t.appendChild(o),n.oninput=e=>{const t=e.target.value.toLowerCase();o.querySelectorAll("label").forEach((e=>{const n=e.textContent.toLowerCase();e.style.display=n.includes(t)?"block":"none"}))},t}#a(e,t){const{x:n,y:o}=t,{xOffset:a,yOffset:i}=this.options.position;e.style.left=`${n+a||this.options.width}px`,e.style.top=`${o+i}px`,e.style.position="fixed"}#i(e){this.options.animation.enabled&&(e.style.opacity=0,e.style.transform="scale(0.9)",e.style.transition=`opacity ${this.options.animation.duration}ms ${this.options.animation.timing}, \n                             transform ${this.options.animation.duration}ms ${this.options.animation.timing}`,requestAnimationFrame((()=>{e.style.opacity=1,e.style.transform="scale(1)"})))}installStyles(){if(document.getElementById("context-menu-styles"))return;const e=document.createElement("style");e.id="context-menu-styles",e.textContent="\n:root {\n  --context-menu-bg: "+(this.options.style.backgroundColor||"#ffffff")+";\n  --context-menu-text: "+(this.options.style.textColor||"#333333")+";\n  --context-menu-hover-bg: "+(this.options.style.backgroundHoverColor||"#f0f0f0")+";\n  --context-menu-border: "+(this.options.style.border||"rgba(0, 0, 0, 0.08)")+";\n  --context-menu-shadow: "+(this.options.style.shadow||"0 10px 25px rgba(0, 0, 0, 0.1)")+";\n  --context-menu-accent: "+(this.options.style.accent||"#3b82f6")+";\n  --context-menu-separator: "+(this.options.style.separator||"rgba(0, 0, 0, 0.08)")+";\n  --padding: "+(this.options.style.padding||"10px")+";\n  --padding-horizontal: "+(this.options.style.paddingHorizontal||"15px")+";\n  --gap: "+(this.options.style.gap||"10px")+";\n  --border-radius: "+(this.options.style.borderRadius||"8px")+";\n  --border-radius-input: "+(this.options.style.borderRadiusInput||"4px")+";\n  --font-size: "+(this.options.style.fontSize||"14px")+";\n  --transition: "+(this.options.style.transition||"0.2s")+" ease;\n  --transition-fast: "+(this.options.style.transitionFast||"0.1s")+" ease;\n  --transition-input: "+(this.options.style.transitionInput||"0.2s")+" ease;\n}\n\n.context-menu {\n  background: var(--context-menu-bg);\n  border: 1px solid var(--context-menu-border);\n  border-radius: var(--border-radius);\n  box-shadow: var(--context-menu-shadow);\n  padding: var(--padding) 0;\n  min-width: 220px;\n  z-index: 1000;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n  color: var(--context-menu-text);\n  animation: contextMenuSlideIn var(--transition-fast) forwards;\n  transform-origin: top center;\n}\n\n.context-menu:has(> .context-menu-dropdown)::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 500%;\n    z-index: -1;\n}\n\n.context-menu-button,\n.context-menu-submenu {\n  display: flex;\n  align-items: center;\n  width: 100%;\n  padding: calc(var(--padding) + 2px) var(--padding-horizontal);\n  border: none;\n  background: none;\n  font-size: var(--font-size);\n  text-align: left;\n  cursor: pointer;\n  color: var(--context-menu-text);\n  transition: background-color var(--transition-fast), color var(--transition-fast);\n  position: relative;\n  gap: var(--gap);\n}\n\n.context-menu-button:disabled {\n  color: rgba(26, 26, 26, 0.4);\n  cursor: not-allowed;\n}\n\n.context-menu-button[data-marked=\"true\"] {\n  font-weight: bold;\n  background-color: var(--context-menu-accent);\n  color: white;\n  border-radius: calc(var(--border-radius) / 2);\n  border: 1px solid var(--context-menu-accent);\n}\n\n.context-menu-button[data-marked=\"true\"]:hover {\n  background-color: var(--context-menu-accent);\n  color: white;\n}\n\n.context-menu-button span,\n.context-menu-submenu span {\n  display: flex;\n  align-items: center;\n  pointer-events: none;\n}\n\n.context-menu-button:hover,\n.context-menu-submenu:hover {\n  background-color: var(--context-menu-hover-bg);\n}\n\n.context-menu-button:focus,\n.context-menu-submenu:focus {\n  outline: none;\n  background-color: var(--context-menu-hover-bg);\n}\n\n.context-menu-separator {\n  height: 1px;\n  background-color: var(--context-menu-separator);\n  margin: var(--padding) 0;\n}\n\n.context-menu-input {\n  padding: var(--padding) var(--padding-horizontal);\n}\n\n.context-menu-input input {\n  width: calc(100% - var(--padding-horizontal));\n  padding: var(--padding);\n  border: 1px solid var(--context-menu-border);\n  border-radius: var(--border-radius-input);\n  font-size: var(--font-size);\n  background-color: #f9fafb;\n  transition: border-color var(--transition-input), box-shadow var(--transition-input);\n}\n\n.context-menu-input input:focus {\n  outline: none;\n  border-color: var(--context-menu-accent);\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n}\n\n.context-menu-dropdown {\n  width: calc(100% - calc(var(--padding-horizontal) * 2));\n  margin: var(--padding) var(--padding-horizontal);\n  padding: var(--padding);\n  border: 1px solid var(--context-menu-border);\n  border-radius: var(--border-radius-input);\n  font-size: var(--font-size);\n  background-color: #f9fafb;\n  transition: border-color var(--transition-input), box-shadow var(--transition-input);\n}\n\n.context-menu-checkbox,\n.context-menu-radio {\n  display: flex;\n  align-items: center;\n  padding: calc(var(--padding) + 2px) var(--padding-horizontal);\n  font-size: var(--font-size);\n  cursor: pointer;\n  transition: background-color var(--transition-fast);\n}\n\n.context-menu-checkbox:hover,\n.context-menu-radio:hover {\n  background-color: var(--context-menu-hover-bg);\n}\n\n.context-menu-checkbox input,\n.context-menu-radio input {\n  margin-right: var(--gap);\n  accent-color: var(--context-menu-accent);\n}\n\n.context-menu-checkbox input:focus,\n.context-menu-radio input:focus {\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n}\n\n.context-menu-checkbox input:checked,\n.context-menu-radio input:checked {\n  background-color: var(--context-menu-accent);\n}\n\n.context-menu-search-select {\n  display: flex;\n  flex-direction: column;\n  padding: calc(var(--padding) + 2px) var(--padding-horizontal);\n}\n\n.context-menu-search-select input {\n  padding: var(--padding);\n  border: 1px solid var(--context-menu-border);\n  border-radius: var(--border-radius-input);\n  font-size: var(--font-size);\n  background-color: #f9fafb;\n  transition: border-color var(--transition-input), box-shadow var(--transition-input);\n}\n\n.context-menu-search-select input:focus {\n  outline: none;\n  border-color: var(--context-menu-accent);\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n}\n\n.context-menu-search-select-list {\n  max-height: 200px;\n  overflow-y: auto;\n  margin-top: var(--padding);\n}\n\n.context-menu-search-select-list button {\n    width: 100%;\n    padding: var(--padding);\n    background: #007BFF;\n    font-size: var(--font-size);\n    text-align: left;\n    cursor: pointer;\n    color: #ffffff;\n    transition: background-color var(--transition-fast), color var(--transition-fast);\n}\n\n.context-menu-search-select-list label {\n  display: flex;\n  flex-direction: row-reverse;\n  gap: var(--gap);\n  align-items: center;\n  padding: var(--padding) 0;\n  justify-content: flex-end;\n}\n\n.context-menu-search-select-list label:hover {\n  background-color: var(--context-menu-hover-bg);\n}\n\n.context-menu-search-select-list input {\n  margin-right: var(--gap);\n  accent-color: var(--context-menu-accent);\n}\n\n.context-menu-search-select-list input:focus {\n  outline: none;\n  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);\n}\n\n.context-menu-submenu {\n  position: relative;\n}\n\n/* Animation */\n@keyframes contextMenuSlideIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(calc(-1 * var(--padding)));\n  }\n}\n\n/* Focus and Accessibility */\n.context-menu:focus {\n  outline: none;\n}\n\n.context-menu-button:focus-visible,\n.context-menu-submenu:focus-visible {\n  outline: 2px solid var(--context-menu-accent);\n  outline-offset: -2px;\n}\n",document.head.appendChild(e)}}
//# sourceMappingURL=ContextMenu.js.map